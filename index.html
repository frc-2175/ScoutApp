<!DOCTYPE html>
<html>

<head>
	<link rel="stylesheet" href="style.css">
	<script>
		const key = "Q8VmErPZQKVkOGqbT76NUCU4FhIurBBNVNhWRvRi2dAce33qRWxnCeMvFJntmFcY"

		function getValue(id) {
			return document.getElementById(id).value || 0
		}

		function setValue(id, value) {
			document.getElementById(id).value = value
		}

		function teleHi(change) {
			const value = getValue("teleHiGoal")
			setValue("teleHiGoal", Math.max(parseInt(value) + change, 0))
		}

		function teleLo(change) {
			const value = getValue("teleLoGoal")
			setValue("teleLoGoal", Math.max(parseInt(value) + change, 0))
		}

		function autoHi(change) {
			const value = getValue("autoHiGoal")
			setValue("autoHiGoal", Math.max(parseInt(value) + change, 0))
		}

		function autoLo(change) {
			const value = getValue("autoLoGoal")
			setValue("autoLoGoal", Math.max(parseInt(value) + change, 0))
		}

		async function getTeam() {
			let url = "https://www.thebluealliance.com/api/v3/team/frc" + getValue("teamNumber")
			let teamName = await fetch(url, { headers: { "X-TBA-Auth-Key": key } })
				.then(response => response.json())
				.then(team => team.nickname);

			teamName = teamName === undefined ? "No team with that number :(" : teamName

			document.getElementById("teamName").innerText = teamName
		}

		function exportData() {
			const match = getValue("matchNumber")
			const team = getValue("teamNumber")
			const teleHi = getValue("teleHiGoal")
			const teleLo = getValue("teleLoGoal")
			const autoHi = getValue("autoHiGoal")
			const autoLo = getValue("autoLoGoal")

			const matchData = {
				match: match,
				team: team,
				teleop: {
					hi: teleHi,
					lo: teleLo
				},
				auto: {
					hi: autoHi,
					lo: autoLo
				}
			}

			console.log(matchData)

			// TODO: something with this matchdata
		}
	</script>
	<meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
	<div class="wrapper">
		<div class="matchInfo">
			<div>
				<h2 style="display: inline;">Match Number: </h2>
				<input id="matchNumber" type="number" placeholder="0">
			</div>
			<div>
				<h2 style="display: inline;">Team Number: </h2>
				<input id="teamNumber" type="number" placeholder="0" onchange="getTeam()">
				<h3 id="teamName"><br></h3>
			</div>
		</div>
		<div class="auto">
			<h1>Auto</h1>
			<div>
				<h3>High Goal</h3>
				<button class="button-3d red" onclick="autoHi(-1)">-</button>
				<input id="autoHiGoal" type="number" placeholder="0" min="0">
				<button class="button-3d green" onclick="autoHi(1)">+</button>
			</div>
			<div>
				<h3>Low Goal</h3>
				<button class="button-3d red" onclick="autoLo(-1)">-</button>
				<input id="autoLoGoal" type="number" placeholder="0" min="0">
				<button class="button-3d green" onclick="autoLo(1)">+</button>
			</div>
		</div>
		<div class="teleop">
			<h1>Teleop</h1>
			<div>
				<h3>High Goal</h3>
				<button class="button-3d red" onclick="teleHi(-1)">-</button>
				<input id="teleHiGoal" type="number" placeholder="0" min="0">
				<button class="button-3d green" onclick="teleHi(1)">+</button>
			</div>
			<div>
				<h3>Low Goal</h3>
				<button class="button-3d red" onclick="teleLo(-1)">-</button>
				<input id="teleLoGoal" type="number" placeholder="0" min="0">
				<button class="button-3d green" onclick="teleLo(1)">+</button>
			</div>
		</div>
		<div>
			<button class="button-3d sky" onclick="exportData()">Export!</button>
		</div>
	</div>
</body>

</html>